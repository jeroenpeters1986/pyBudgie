{% extends "admin/base_site.html" %}
{% load static %}
{% load i18n %}

{% block extrahead %}
    {{ block.super }}
    {% comment %}I had rather used the admins Media class, but this is a custom view {% endcomment %}
    <link rel="stylesheet" href="{% static 'admin/css/forms.css' %}" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/treant-js/1.0/Treant.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script>
    <script src="{% static 'js/treant.js' %}"></script>

    <style>
    .submit-row {
        padding: 20px 14px;
    }
    .admin-interface a.button {
        padding: 10px 15px;
        line-height: 15px;
        margin: 0 0 5px 5px;
    }

    .family-node {
        padding: 4px;
        border-radius: 5px;
        background-color: #ffffff;
        border: 2px solid #000;
        width: 200px;
        font-size: small;
    }

    .family-node img {
        margin: 0 0 0 10px;
        max-width: 90px;
        float: right !important;
    }

    .family-node.pyBudgie_female {
        border-color: deeppink;
    }

    .family-node.pyBudgie_male {
        border-color: dodgerblue;
    }
    .node-name {
        font-weight: bold;
    }


    </style>
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
  &rsaquo; <a href="{% url 'admin:index' %}budgie_bird/">{% trans 'Bird Administration' %}</a>
  &rsaquo; <a href="{% url 'admin:budgie_bird_bird_changelist' %}">{% trans 'Birds' %}</a>
  &rsaquo; <a href="{% url 'admin:budgie_bird_bird_change' bird.pk %}">{{ bird }}</a>
  &rsaquo; {% trans 'Family tree' %}
</div>
{% endblock %}

{% block footer %}
    {{ block.super }}

    <script>
        const familyTreeConfig = {
            chart: {
                rootOrientation: 'WEST',
                container: "#family_tree",
                connectors: {
                    type: "step",
                    style: {
                        "stroke-width": 2,
                        stroke: "#ccc"
                    }
                },
                levelSeparation: 50,
                siblingSeparation: 40,
                node: {
                    HTMLclass: "family-node",
                }
            },
            nodeStructure: {{ family_tree_data|safe }}
        };

        new Treant(familyTreeConfig);
    </script>
{% endblock %}

{% block title %}{% translate "Family tree of" %} {{ bird }}{% endblock %}

{% block content %}

    <h1>{% translate "Family tree of" %} {{ bird }}</h1>

    <div id="content-main">
        <div>
            <div class="submit-row">
                    <a class="button" href="{% url 'admin:budgie_bird_bird_change' bird.pk %}">{% translate "Back to the bird" %}</a>
                    <a class="button" href="{% url 'admin:budgie_bird_bird_changelist' %}">{% translate "Back to the overview" %}</a>
            </div>
        </div>

        <div id="family_tree"></div>

    </div>

{% endblock %}